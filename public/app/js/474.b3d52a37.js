"use strict";(self["webpackChunkimage_management"]=self["webpackChunkimage_management"]||[]).push([[474],{4575:function(t,e,a){a.r(e),a.d(e,{default:function(){return j}});var s=function(){var t=this,e=t._self._c;return e("el-container",[e("el-header",{staticClass:"admin-header"},[e("div",{staticClass:"admin-header__logo"},[e("img",{attrs:{src:a(2781)}})]),e("div",{staticClass:"admin-header__title"},[e("span",[t._v("图片管理系统后台")])]),e("router-link",{attrs:{to:"/"}},[e("span",{staticStyle:{color:"#fff"}},[t._v("首页")])])],1),e("el-main",[e("image-list")],1)],1)},n=[],i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"image-list"},[e("div",{staticClass:"image-list__content"},[t._l(t.imageList,(function(a){return e("image-card",{key:a.id,attrs:{"image-detail":a,"img-src":a.url,"thumbnail-src":a.thumbnailUrl,"review-status":a.reviewStatus},on:{click:t.handleClick,delete:function(e){return t.deleteFile(a.id)},pass:function(e){return t.updateStatus(a.id,"pass")},reject:function(e){return t.updateStatus(a.id,"reject")},setTop:function(e){return t.setTopImage(a.id)}}})})),t.imageList.length?t._e():e("el-empty",{attrs:{description:"这里空空如也 /(ㄒoㄒ)/~~"}})],2),e("div",{staticClass:"image-list__footer"},[e("el-pagination",{attrs:{"current-page":t.queryInfo.pageNumber,"page-size":t.queryInfo.pageSize,layout:"total, prev, pager, next, jumper",total:t.total},on:{"current-change":t.fetchData,"update:currentPage":function(e){return t.$set(t.queryInfo,"pageNumber",e)},"update:current-page":function(e){return t.$set(t.queryInfo,"pageNumber",e)}}})],1),e("image-modal",{attrs:{showModal:t.showModal,images:t.imageList,currentIndex:t.currentIndex},on:{"update:showModal":function(e){t.showModal=e},"update:show-modal":function(e){t.showModal=e},"update:currentIndex":function(e){t.currentIndex=e},"update:current-index":function(e){t.currentIndex=e},pass:t.updateStatus,reject:t.updateStatus},scopedSlots:t._u([{key:"header",fn:function({image:a}){return[e("div",{staticStyle:{flex:"1"}},[e("el-button",{attrs:{round:"",type:"success",size:"mini"},on:{click:function(e){return t.updateStatus(a.id,"pass")}}},[t._v(" 通过 ")]),e("el-button",{attrs:{round:"",type:"danger",size:"mini"},on:{click:function(e){return t.updateStatus(a.id,"reject")}}},[t._v(" 拒绝 ")]),e("status",{staticStyle:{"margin-left":"10px"},attrs:{status:a.reviewStatus}})],1)]}}])})],1)},r=[],c=a(4806),u=a.n(c),o=function(){var t=this,e=t._self._c;return e("el-card",{staticClass:"image-card"},[e("el-badge",{staticClass:"image-card__top",attrs:{hidden:!t.imageDetail.isTop,value:"置顶"}},[e("div",{staticClass:"image-card__img",style:t.imgStyle,on:{click:function(e){return t.$emit("click",t.imageDetail)}}})]),e("div",{staticClass:"image-card__footer"},[e("div",[e("el-button",{staticStyle:{color:"#67c23a"},attrs:{type:"text"},on:{click:function(e){return t.$emit("pass")}}},[t._v(" 通过 ")]),e("el-button",{staticStyle:{color:"#f56c6c"},attrs:{type:"text"},on:{click:function(e){return t.$emit("reject")}}},[t._v(" 拒绝 ")]),e("el-button",{staticStyle:{color:"red"},attrs:{type:"text"},on:{click:function(e){return t.$emit("delete")}}},[t._v(" 删除 ")]),e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.$emit("setTop")}}},[t._v(" 置顶 ")])],1),e("status",{staticClass:"image-card__status",attrs:{status:t.reviewStatus}})],1)],1)},l=[];const d={pass:{type:"success",text:"已通过"},reject:{type:"danger",text:"已拒绝"},pending:{type:"info",text:"未审核"}};var m,p,g={name:"Status",props:["status"],render(t){const{status:e="pending"}=this,{type:a,text:s}=d[e];return t("el-tag",{props:{type:a}},s)}},f=g,h=a(1001),y=(0,h.Z)(f,m,p,!1,null,null,null),_=y.exports,v={name:"ImageCard",props:["img-src","thumbnail-src","review-status","image-detail"],computed:{imgStyle(){return{background:`url(${this.thumbnailSrc}) no-repeat center/cover`}}},components:{Status:_}},x=v,S=(0,h.Z)(x,o,l,!1,null,"c6b51f22",null),b=S.exports,w=a(4561),I=a(3022),k={name:"ImageList",components:{ImageModal:w.Z,ImageCard:b,Status:_},created(){this.fetchData()},data(){return{imageList:[],total:0,queryInfo:{pageNumber:1,pageSize:20},showModal:!1,currentIndex:0}},methods:{async fetchData(){try{const{data:t}=await(0,I.cO)(this.queryInfo),{files:e,count:a}=t;this.imageList=e,this.total=a}catch(t){console.log(t)}},async deleteFile(t){try{await this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await(0,I.TL)(t),this.$message.success({message:"文件删除成功",duration:1500}),this.fetchData()}catch(e){console.log(e)}},async updateStatus(t,e){try{await(0,I.kn)(t,e),this.$message.success({message:"操作成功",duration:1500}),this.updateData(t,e)}catch(a){this.$message.error("操作失败，请重试"),console.log(a)}},async setTopImage(t){try{await(0,I.o7)(t),this.$message.success({message:"置顶成功",duration:1500})}catch(e){this.$message.error("操作失败，请重试"),console.log(e)}},updateData(t,e){const a=this.imageList;let s;const n=a.find(((e,a)=>(s=a,e.id===t))),i=u().cloneDeep(n);i.reviewStatus=e,a.splice(s,1,i)},handleClick(t){this.showModal=!0;const e=u().findIndex(this.imageList,t);this.currentIndex=e}}},C=k,$=(0,h.Z)(C,i,r,!1,null,"75bb19b7",null),L=$.exports,D={components:{ImageList:L},name:"Admin"},M=D,T=(0,h.Z)(M,s,n,!1,null,"2363c208",null),j=T.exports}}]);