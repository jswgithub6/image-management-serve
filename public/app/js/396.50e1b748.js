"use strict";(self["webpackChunkimage_management"]=self["webpackChunkimage_management"]||[]).push([[396],{9396:function(t,s,a){a.r(s),a.d(s,{default:function(){return x}});var e=function(){var t=this,s=t._self._c;return s("div",{staticClass:"image-upload"},[s("div",{staticClass:"image-upload__container"},[s("div",{staticClass:"image-upload__header"},[s("h1",[t._v("发布图片")]),s("router-link",{attrs:{to:"/"}},[s("span",[t._v("返回首页")])])],1),s("div",{staticClass:"image-upload__content"},[s("div",{staticClass:"image-upload__label"},[t._v("上传图片:")]),s("upload")],1),s("div",{staticClass:"image-upload__footer"},[s("div",{staticClass:"image-upload__submit",on:{click:t.handleSave}},[s("button",[t._v("保存")])])])])])},i=[],l=function(){var t=this,s=t._self._c;return s("div",{staticClass:"upload"},[s("ul",{staticClass:"upload-list"},t._l(t.filesList,(function(a){return s("li",{key:a.uid,staticClass:"upload-list__item"},[s("div",{staticClass:"upload-list__item-thumbnail",style:{background:`url(${a.url}) no-repeat center/cover`}}),"uploading"===a.status?s("Loading"):t._e(),s("div",{staticClass:"upload-list__item-actions"},[s("i",{staticClass:"delete-icon icon-bin",on:{click:function(s){return t.handleDelete(a)}}})])],1)})),0),s("div",{staticClass:"upload-card",on:{click:t.handleClick}},[s("div",{staticClass:"upload-card__content"},[s("i",{staticClass:"icon-plus"}),s("span",[t._v("点击添加图片")]),s("span",{staticClass:"upload-card__tip"},[t._v("支持格式jpg、png、jpeg、gif")]),s("input",{ref:"input",attrs:{type:"file",accept:"image/png, image/jpeg, image/jpg, image/gif",multiple:"multiple"},on:{change:t.handleChange}})])])])},n=[];a(7658);const c=function(){let t=0;return()=>t++}();var o=a(3022),u=function(){var t=this,s=t._self._c;return s("div",{staticClass:"loading-mask"},[s("div",{staticClass:"loading"},[s("i",{staticClass:"loading-icon icon-spinner2"}),t.text?s("div",{staticClass:"loading-text"},[s("span",[t._v(t._s(t.text))])]):t._e()])])},d=[],r={name:"Loading",props:["text"]},p=r,g=a(1001),h=(0,g.Z)(p,u,d,!1,null,"da633444",null),_=h.exports,f={name:"Upload",components:{Loading:_},data(){return{filesList:[],uploadFiles:[]}},methods:{async handleDelete(t){const s=this.getFile(t),a=this.uploadFiles;a.splice(a.indexOf(s),1);const e=t.response&&t.response.file;if(e){const{id:t}=e;try{await(0,o.TL)(t)}catch(i){console.log(i)}}},handleClick(){this.$refs.input.click()},handleChange(t){const s=t.target.files;if(!s||!s.length)return;const a=[].slice.call(s);a.forEach((t=>{t.uid=c();const s={status:"ready",name:t.name,size:t.size,percentage:0,uid:t.uid,raw:t,url:URL.createObjectURL(t)};this.uploadFiles.push(s),this.upload(t)})),this.filesList=this.uploadFiles},async upload(t){this.$refs.input.value=null;const s=new FormData;s.append("file",t,t.name);const a=s=>{const a=this.getFile(t);a.status="uploading",a.percentage=s.percent||0};try{const e=await(0,o.cT)(s,a);this.handleSuccess(e,t)}catch(e){this.handleError(e,t),console.log(e)}},handleSuccess(t,s){const a=this.getFile(s);a&&(a.status="success",a.response=t)},handleError(t,s){const a=this.getFile(s),e=this.uploadFiles;a.status="fail",e.splice(e.indexOf(a),1)},getFile(t){const s=this.uploadFiles;return s.find((s=>s.uid===t.uid))}}},m=f,v=(0,g.Z)(m,l,n,!1,null,"22514079",null),C=v.exports,k={components:{Upload:C},methods:{handleSave(){this.$router.replace("/")}}},F=k,b=(0,g.Z)(F,e,i,!1,null,"9322fbfe",null),x=b.exports}}]);